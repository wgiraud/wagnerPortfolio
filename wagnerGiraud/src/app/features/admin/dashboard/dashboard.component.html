<div class="dashboard-page">
  <header class="topbar">
    <p class="brand">Dashboard</p>

    <div class="actions">
      <a class="ghost-btn" routerLink="/welcome">Ver Welcome</a>
      <button type="button" class="ghost-btn" (click)="logout()">Sair</button>
    </div>
  </header>

  <main class="layout">
    <section class="editor">
      <h1>Editar conteudo do welcome</h1>
      <p class="hint">
        Cada projeto agora possui apenas titulo, descricao e link. Ao salvar um projeto, o
        formulario e limpo para o proximo cadastro.
      </p>

      <form [formGroup]="form" (ngSubmit)="save()">
        <label for="heroTitle">Titulo</label>
        <input id="heroTitle" type="text" formControlName="heroTitle" />

        <label for="heroDescription">Descricao</label>
        <textarea id="heroDescription" rows="3" formControlName="heroDescription"></textarea>

        <div class="project-editor">
          <div class="project-editor-head">
            <label>Novo projeto</label>
            <p>Preencha um por vez e clique em salvar.</p>
          </div>

          <article class="project-form-card" formGroupName="projectDraft">
            <label for="projectName">Titulo</label>
            <input id="projectName" type="text" formControlName="name" placeholder="Nome do projeto" />

            <label for="projectDescription">Descricao</label>
            <textarea
              id="projectDescription"
              rows="2"
              formControlName="description"
              placeholder="Resumo curto do projeto"
            ></textarea>

            <label for="projectUrl">Link</label>
            <input id="projectUrl" type="url" formControlName="url" placeholder="https://projeto.com" />
          </article>

          <section class="saved-projects">
            <label>Projetos cadastrados</label>
            @if (content().projects.length > 0) {
              <ul>
                @for (project of content().projects; track project.name + '-' + $index) {
                  <li>
                    <div class="saved-project-copy">
                      <strong>{{ project.name }}</strong>
                      @if (project.description) {
                        <small class="project-desc">{{ project.description }}</small>
                      }
                      @if (project.url) {
                        <a [href]="project.url" target="_blank" rel="noopener noreferrer">Abrir projeto</a>
                      }
                    </div>
                    <button
                      type="button"
                      class="ghost-inline-btn"
                      (click)="removeProject($index)"
                    >
                      Remover
                    </button>
                  </li>
                }
              </ul>
            } @else {
              <p class="saved-projects-empty">Nenhum projeto cadastrado.</p>
            }
          </section>
        </div>

        <label for="skills">Habilidades</label>
        <textarea id="skills" rows="5" formControlName="skills"></textarea>

        <label for="languages">Linguagens</label>
        <textarea id="languages" rows="5" formControlName="languages"></textarea>

        <div class="form-actions">
          <button type="submit">Salvar e abrir novo formulario</button>
          <button type="button" class="secondary" (click)="restoreDefaults()">Restaurar padrao</button>
        </div>

        @if (statusMessage()) {
          <p class="feedback">{{ statusMessage() }}</p>
        }
      </form>
    </section>

    <section class="preview">
      <h2>Preview publicado</h2>
      <article class="preview-card">
        <h3>{{ content().heroTitle }}</h3>
        <p>{{ content().heroDescription }}</p>

        <h4>Projetos</h4>
        <ul>
          @for (project of content().projects; track project.name + '-' + $index) {
            <li>
              <strong>{{ project.name }}</strong>
              @if (project.description) {
                <small class="project-desc">{{ project.description }}</small>
              }
              @if (project.url) {
                <a [href]="project.url" target="_blank" rel="noopener noreferrer">Abrir projeto</a>
              }
            </li>
          }
        </ul>

        <h4>Habilidades</h4>
        <ul>
          @for (skill of content().skills; track skill) {
            <li>{{ skill }}</li>
          }
        </ul>

        <h4>Linguagens</h4>
        <ul>
          @for (language of content().languages; track language) {
            <li>{{ language }}</li>
          }
        </ul>
      </article>
    </section>
  </main>
</div>
